<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>SimpleES</title>

        <link href="https://simple-es.github.io/css/styles.css" rel="stylesheet" type="text/css">
        <link href="https://simple-es.github.io/css/highlight-solarized-light.css" rel="stylesheet" type="text/css">
    </head>
    <body>

        <header class="navbar navbar-default navbar-fixed-top">

            <a class="navbar-brand" href="https://simple-es.github.io/">
                SimpleES
                <small class="hidden-xs">
                    A collection of &quot;simple&quot; Event Sourcing libraries for PHP
                </small>
            </a>

            
        </header>

        <main class="container-fluid">
            <div class="row">

                
                    <nav class="sidebar col-sm-3 col-lg-2" role="navigation">

                                                                                    <p class="sidebar-section">
                                    Event Sourcing
                                </p>
                            
                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="https://simple-es.github.io/">
                                            Home
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://simple-es.github.io/event-sourcing/events">
                                            Events
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://simple-es.github.io/event-sourcing/aggregates">
                                            Aggregates
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://simple-es.github.io/event-sourcing/aggregate-manager">
                                            Aggregate Manager
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://simple-es.github.io/event-sourcing/event-store">
                                            Event Store
                                        </a>
                                    </li>
                                                            </ul>
                                                                                    <p class="sidebar-section">
                                    Bridges
                                </p>
                            
                            <ul class="nav nav-pills nav-stacked">
                                                                    <li class="">
                                        <a href="https://simple-es.github.io/bridges/doctrine-dbal">
                                            Doctrine DBAL
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://simple-es.github.io/bridges/jms-serializer">
                                            JMS Serializer
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://simple-es.github.io/bridges/ramsey-uuid">
                                            Ramsey UUID
                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://simple-es.github.io/bridges/message-bus">
                                            SimpleBus
                                        </a>
                                    </li>
                                                            </ul>
                        
                    </nav>

                
                <section class="col-sm-offset-3 col-lg-offset-2 col-sm-9 col-lg-10">
                    <p>If you want to write an option parser, and have it be good, there are
two ways to do it.  The Right Way, and the Wrong Way.</p>
<p>The Wrong Way is to sit down and write an option parser.  We've all done
that.</p>
<p>The Right Way is to write some complex configurable program with so many
options that you go half-insane just trying to manage them all, and put
it off with duct-tape solutions until you see exactly to the core of the
problem, and finally snap and write an awesome option parser.</p>
<p>If you want to write an option parser, don't write an option parser.
Write a package manager, or a source control system, or a service
restarter, or an operating system.  You probably won't end up with a
good one of those, but if you don't give up, and you are relentless and
diligent enough in your procrastination, you may just end up with a very
nice option parser.</p>
<h2>USAGE</h2>
<pre><code>// my-program.js
var nopt = require("nopt")
  , Stream = require("stream").Stream
  , path = require("path")
  , knownOpts = { "foo" : [String, null]
                , "bar" : [Stream, Number]
                , "baz" : path
                , "bloo" : [ "big", "medium", "small" ]
                , "flag" : Boolean
                , "pick" : Boolean
                , "many" : [String, Array]
                }
  , shortHands = { "foofoo" : ["--foo", "Mr. Foo"]
                 , "b7" : ["--bar", "7"]
                 , "m" : ["--bloo", "medium"]
                 , "p" : ["--pick"]
                 , "f" : ["--flag"]
                 }
             // everything is optional.
             // knownOpts and shorthands default to {}
             // arg list defaults to process.argv
             // slice defaults to 2
  , parsed = nopt(knownOpts, shortHands, process.argv, 2)
console.log(parsed)</code></pre>
<p>This would give you support for any of the following:</p>
<pre><code class="language-bash">$ node my-program.js --foo "blerp" --no-flag
{ "foo" : "blerp", "flag" : false }

$ node my-program.js ---bar 7 --foo "Mr. Hand" --flag
{ bar: 7, foo: "Mr. Hand", flag: true }

$ node my-program.js --foo "blerp" -f -----p
{ foo: "blerp", flag: true, pick: true }

$ node my-program.js -fp --foofoo
{ foo: "Mr. Foo", flag: true, pick: true }

$ node my-program.js --foofoo -- -fp  # -- stops the flag parsing.
{ foo: "Mr. Foo", argv: { remain: ["-fp"] } }

$ node my-program.js --blatzk 1000 -fp # unknown opts are ok.
{ blatzk: 1000, flag: true, pick: true }

$ node my-program.js --blatzk true -fp # but they need a value
{ blatzk: true, flag: true, pick: true }

$ node my-program.js --no-blatzk -fp # unless they start with "no-"
{ blatzk: false, flag: true, pick: true }

$ node my-program.js --baz b/a/z # known paths are resolved.
{ baz: "/Users/isaacs/b/a/z" }

# if Array is one of the types, then it can take many
# values, and will always be an array.  The other types provided
# specify what types are allowed in the list.

$ node my-program.js --many 1 --many null --many foo
{ many: ["1", "null", "foo"] }

$ node my-program.js --many foo
{ many: ["foo"] }</code></pre>
<p>Read the tests at the bottom of <code>lib/nopt.js</code> for more examples of
what this puppy can do.</p>
<h2>Types</h2>
<p>The following types are supported, and defined on <code>nopt.typeDefs</code></p>
<ul>
<li>String: A normal string.  No parsing is done.</li>
<li>path: A file system path.  Gets resolved against cwd if not absolute.</li>
<li>url: A url.  If it doesn't parse, it isn't accepted.</li>
<li>Number: Must be numeric.</li>
<li>Date: Must parse as a date. If it does, and <code>Date</code> is one of the options,
then it will return a Date object, not a string.</li>
<li>Boolean: Must be either <code>true</code> or <code>false</code>.  If an option is a boolean,
then it does not need a value, and its presence will imply <code>true</code> as
the value.  To negate boolean flags, do <code>--no-whatever</code> or <code>--whatever false</code></li>
<li>NaN: Means that the option is strictly not allowed.  Any value will
fail.</li>
<li>Stream: An object matching the &quot;Stream&quot; class in node.  Valuable
for use when validating programmatically.  (npm uses this to let you
supply any WriteStream on the <code>outfd</code> and <code>logfd</code> config options.)</li>
<li>Array: If <code>Array</code> is specified as one of the types, then the value
will be parsed as a list of options.  This means that multiple values
can be specified, and that the value will always be an array.</li>
</ul>
<p>If a type is an array of values not on this list, then those are
considered valid values.  For instance, in the example above, the
<code>--bloo</code> option can only be one of <code>"big"</code>, <code>"medium"</code>, or <code>"small"</code>,
and any other value will be rejected.</p>
<p>When parsing unknown fields, <code>"true"</code>, <code>"false"</code>, and <code>"null"</code> will be
interpreted as their JavaScript equivalents, and numeric values will be
interpreted as a number.</p>
<p>You can also mix types and values, or multiple types, in a list.  For
instance <code>{ blah: [Number, null] }</code> would allow a value to be set to
either a Number or null.</p>
<p>To define a new type, add it to <code>nopt.typeDefs</code>.  Each item in that
hash is an object with a <code>type</code> member and a <code>validate</code> method.  The
<code>type</code> member is an object that matches what goes in the type list.  The
<code>validate</code> method is a function that gets called with <code>validate(data, key, val)</code>.  Validate methods should assign <code>data[key]</code> to the valid
value of <code>val</code> if it can be handled properly, or return boolean
<code>false</code> if it cannot.</p>
<p>You can also call <code>nopt.clean(data, types, typeDefs)</code> to clean up a
config object and remove its invalid properties.</p>
<h2>Error Handling</h2>
<p>By default, nopt outputs a warning to standard error when invalid
options are found.  You can change this behavior by assigning a method
to <code>nopt.invalidHandler</code>.  This method will be called with
the offending <code>nopt.invalidHandler(key, val, types)</code>.</p>
<p>If no <code>nopt.invalidHandler</code> is assigned, then it will console.error
its whining.  If it is assigned to boolean <code>false</code> then the warning is
suppressed.</p>
<h2>Abbreviations</h2>
<p>Yes, they are supported.  If you define options like this:</p>
<pre><code class="language-javascript">{ "foolhardyelephants" : Boolean
, "pileofmonkeys" : Boolean }</code></pre>
<p>Then this will work:</p>
<pre><code class="language-bash">node program.js --foolhar --pil
node program.js --no-f --pileofmon
# etc.</code></pre>
<h2>Shorthands</h2>
<p>Shorthands are a hash of shorter option names to a snippet of args that
they expand to.</p>
<p>If multiple one-character shorthands are all combined, and the
combination does not unambiguously match any other option or shorthand,
then they will be broken up into their constituent parts.  For example:</p>
<pre><code class="language-json">{ "s" : ["--loglevel", "silent"]
, "g" : "--global"
, "f" : "--force"
, "p" : "--parseable"
, "l" : "--long"
}</code></pre>
<pre><code class="language-bash">npm ls -sgflp
# just like doing this:
npm ls --loglevel silent --global --force --long --parseable</code></pre>
<h2>The Rest of the args</h2>
<p>The config object returned by nopt is given a special member called
<code>argv</code>, which is an object with the following fields:</p>
<ul>
<li><code>remain</code>: The remaining args after all the parsing has occurred.</li>
<li><code>original</code>: The args as they originally appeared.</li>
<li><code>cooked</code>: The args after flags and shorthands are expanded.</li>
</ul>
<h2>Slicing</h2>
<p>Node programs are called with more or less the exact argv as it appears
in C land, after the v8 and node-specific options have been plucked off.
As such, <code>argv[0]</code> is always <code>node</code> and <code>argv[1]</code> is always the
JavaScript program being run.</p>
<p>That's usually not very useful to you.  So they're sliced off by
default.  If you want them, then you can pass in <code>0</code> as the last
argument, or any other number that you'd like to slice off the start of
the list.</p>
                </section>

            </div>
        </main>

        <footer>
            <div class="container-fluid">
                <p class="text-muted">
                    website generated with <a href="http://couscous.io" title="Markdown website generator">Couscous</a>
                </p>
            </div>
        </footer>

        <script src="https://simple-es.github.io/js/jquery.min.js" type="text/javascript"></script>
        <script src="https://simple-es.github.io/js/bootstrap.min.js" type="text/javascript"></script>
        <script src="https://simple-es.github.io/js/highlight.min.js" type="text/javascript"></script>

        <script>
            $(function() {
                $("section>h1").wrap('<div class="page-header" />');
                // Syntax highlighting
                hljs.initHighlightingOnLoad();
            });
        </script>

    </body>
</html>
